#!/bin/sh

# after virtual device added, we need to set the real device volume to maximum, so grab the real device id
number=$(wpctl status | grep -m 1 "Built-in Audio Headphones" | grep -Eo '[0-9]+' | awk 'NR==1{print; exit}')

if [ -n "$number" ]; then
  # Set the volume to 100% with the extracted id 
  wpctl set-volume "$number" 1
  echo "Default set to $number"
else
  echo "Error: Unable to extract number from command output."
fi

# start virtual audio driver

VAUDIODRV=$(get_setting audio.v-driver)

if [ -z "${VAUDIODRV}" ]
then
  /usr/bin/audio_vdriver.sh --start
else
  /usr/bin/audio_vdriver.sh ${VAUDIODRV}
fi
